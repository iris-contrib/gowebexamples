<!DOCTYPE html>
<html lang="en">
<head>
	
		<title>GopherBOOk: Upload Files</title>
	
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
	<meta name="description" content="This example will show how to upload files to a specific directory in the Go programming language." />
	<link rel="alternate" type="application/rss+xml" href="/index.xml" />
	<link rel="canonical" href="http://gopherbook.iris-go.com/upload-files/">
	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
	<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
	<meta name="theme-color" content="#bb8844">
	<style>
		body {
			margin: 0;
			font-family: -apple-system, "San Francisco", "Helvetica Neue", "Noto",  "Roboto", "Calibri Light", sans-serif;
			color: #212121;
			font-size: 1.1em;
			line-height: 1.6;
		}
		.container { max-width: 700px; margin: auto; padding: 15px; }
		a {	color: black; }
		p { font-family: "Georgia", serif; margin: 0.5em 0; }
		h1 { margin: 1em 0; }
		h1 a { text-decoration: none; }
		h2 { font-size: 1.2em; margin: 0.5em 0; }
		pre { padding: 15px; overflow-x: auto; background: #fafafa; border: 1px solid #f0f0f0; }
		.demo pre { background-color: white; border: none; margin: 1em 0 0 0; padding: 0; }
		a[target="_blank"] { background: url(/link.svg) right top/9px no-repeat; padding-right: 12px; }
		.links { display: flex; justify-content: space-between; }
		a.back { text-decoration: none; }
		a.home { text-decoration: none; }
		a.forward { text-decoration: none; }
		.footer { font-size: .9em; margin-top: 1em; color: #999; font-family: "Georgia", serif; }
		.footer a { color: #999; }
		.image { border: 1px solid #f0f0f0; }
		.image img { max-width: 100%; height: auto; display: block; }
		.demo { border: 1px solid #f0f0f0; padding: 15px; line-height: 1.4; pointer-events: none; }
		.demo h1 { margin: 0 0 0.5em 0; font-size: 1.5em; }
		.demo input[type=text], .demo textarea { box-sizing: border-box; width: 100%; max-width: 20em; }
	</style>
</head>
<body>
<div class="container">



<h1 id="go-web-examples-upload-files"><a href="/">Go Web Examples:</a> Upload Files</h1>

<p>This example will show how to upload files to a specific directory.</p>

<pre><code>// upload-files.go
package main

import (
    &quot;crypto/md5&quot;
    &quot;fmt&quot;
    &quot;io&quot;
    &quot;os&quot;
    &quot;strconv&quot;
    &quot;time&quot;

    &quot;gopkg.in/kataras/iris.v6&quot;
    &quot;gopkg.in/kataras/iris.v6/adaptors/httprouter&quot;
    &quot;gopkg.in/kataras/iris.v6/adaptors/view&quot;
)

func main() {
    app := iris.New()
    app.Adapt(iris.DevLogger())
    app.Adapt(httprouter.New())
    app.Adapt(view.HTML(&quot;./templates&quot;, &quot;.html&quot;))

    // Serve the form.html to the user
    app.Get(&quot;/upload&quot;, func(ctx *iris.Context) {
        //create a token (optionally)

        now := time.Now().Unix()
        h := md5.New()
        io.WriteString(h, strconv.FormatInt(now, 10))
        token := fmt.Sprintf(&quot;%x&quot;, h.Sum(nil))
        //render the form with the token for any use you like
        ctx.Render(&quot;upload_form.html&quot;, token)
    })

    // Handle the post request from the upload_form.html to the server
    app.Post(&quot;/upload&quot;, iris.LimitRequestBodySize(10&lt;&lt;20),
        func(ctx *iris.Context) {
            // or use ctx.SetMaxRequestBodySize(10 &lt;&lt; 20)
            //to limit the uploaded file(s) size.

            // Get the file from the request
            file, info, err := ctx.FormFile(&quot;uploadfile&quot;)

            if err != nil {
                ctx.HTML(iris.StatusInternalServerError,
                    &quot;Error while uploading: &lt;b&gt;&quot;+err.Error()+&quot;&lt;/b&gt;&quot;)
                return
            }

            defer file.Close()
            fname := info.Filename

            // Create a file with the same name
            // assuming that you have a folder named 'uploads'
            out, err := os.OpenFile(&quot;./uploads/&quot;+fname,
                os.O_WRONLY|os.O_CREATE, 0666)

            if err != nil {
                ctx.HTML(iris.StatusInternalServerError,
                    &quot;Error while uploading: &lt;b&gt;&quot;+err.Error()+&quot;&lt;/b&gt;&quot;)
                return
            }
            defer out.Close()

            io.Copy(out, file)
        })

    // start the server at 127.0.0.1:8080
    app.Listen(&quot;:8080&quot;)
}

</code></pre>

<pre><code>$ tree ./
templates/
└── upload_form.html
uploads/
└──
</code></pre>

<pre><code>$ go run upload-files.go
</code></pre>

<p><html>
<head>
<title>Upload file</title>
</head>
<body>
    <form enctype="multipart/form-data"
        action="http://127.0.0.1:8080/upload" method="post">
        <input type="file" name="uploadfile" /> <input type="hidden"
            name="token" value="{{.}}" /> <input type="submit" value="upload" />
    </form>
</body>
</html></p>

	<div class="footer">
		<div class="links">
		
			
			<a title="Static Files" class="back" href="http://gopherbook.iris-go.com/static-files/">← back</a>
			
			<a title="GopherBOOk" class="home" href="/">home</a>
			
			<a title="Favicon" class="forward" href="http://gopherbook.iris-go.com/favicon/">forward →</a>
			
		
		</div>
		<br /><br />
		 <a href="https://github.com/kataras/iris">Iris web framework</a>
		 <a href="http://support.iris-go.com">Looking for further Support?</a>
	</div>
</div>
</body>
</html>
