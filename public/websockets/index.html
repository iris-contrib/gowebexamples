<!DOCTYPE html>
<html lang="en">
<head>
	
		<title>GopherBOOk: Websockets</title>
	
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
	<meta name="description" content="This example will show how to work with websockets in Go. We will build a simple server which echoes back everything we send to it." />
	<link rel="alternate" type="application/rss+xml" href="/index.xml" />
	<link rel="canonical" href="http://gopherbook.iris-go.com/websockets/">
	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
	<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
	<meta name="theme-color" content="#bb8844">
	<style>
		body {
			margin: 0;
			font-family: -apple-system, "San Francisco", "Helvetica Neue", "Noto",  "Roboto", "Calibri Light", sans-serif;
			color: #212121;
			font-size: 1.1em;
			line-height: 1.6;
		}
		.container { max-width: 700px; margin: auto; padding: 15px; }
		a {	color: black; }
		p { font-family: "Georgia", serif; margin: 0.5em 0; }
		h1 { margin: 1em 0; }
		h1 a { text-decoration: none; }
		h2 { font-size: 1.2em; margin: 0.5em 0; }
		pre { padding: 15px; overflow-x: auto; background: #fafafa; border: 1px solid #f0f0f0; }
		.demo pre { background-color: white; border: none; margin: 1em 0 0 0; padding: 0; }
		a[target="_blank"] { background: url(/link.svg) right top/9px no-repeat; padding-right: 12px; }
		.links { display: flex; justify-content: space-between; }
		a.back { text-decoration: none; }
		a.home { text-decoration: none; }
		a.forward { text-decoration: none; }
		.footer { font-size: .9em; margin-top: 1em; color: #999; font-family: "Georgia", serif; }
		.footer a { color: #999; }
		.image { border: 1px solid #f0f0f0; }
		.image img { max-width: 100%; height: auto; display: block; }
		.demo { border: 1px solid #f0f0f0; padding: 15px; line-height: 1.4; pointer-events: none; }
		.demo h1 { margin: 0 0 0.5em 0; font-size: 1.5em; }
		.demo input[type=text], .demo textarea { box-sizing: border-box; width: 100%; max-width: 20em; }
	</style>
</head>
<body>
<div class="container">



<h1 id="go-web-examples-websockets"><a href="/">Go Web Examples:</a> Websockets</h1>

<p>This example will show how to work with websockets in Go. We will build a simple server which echoes back everything we send to it.
You don&rsquo;t need any third-party library except <code>adaptors/websocket</code>, but if you want you can use anything. Remember: Iris is fully compatible with the standard library.</p>

<p>You can find more websocket examples by pressing <a href="https://github.com/kataras/iris/tree/v6/adaptors/websocket/_examples">here</a>.</p>

<pre><code>// websockets.go
package main

import (
    &quot;fmt&quot;

    &quot;gopkg.in/kataras/iris.v6&quot;
    &quot;gopkg.in/kataras/iris.v6/adaptors/httprouter&quot;
    &quot;gopkg.in/kataras/iris.v6/adaptors/websocket&quot;
)

func handleConnection(c websocket.Connection) {

    // Read events from browser
    c.On(&quot;chat&quot;, func(msg string) {

        // Print the message to the console
        fmt.Printf(&quot;%s sent: %s\n&quot;, c.Context().RemoteAddr(), msg)

        // Write message back to browser
        c.Emit(&quot;chat&quot;, msg)
    })

}

func main() {
    app := iris.New()
    app.Adapt(httprouter.New())

    // create our echo websocket server
    ws := websocket.New(websocket.Config{
        ReadBufferSize:  1024,
        WriteBufferSize: 1024,
        Endpoint:        &quot;/echo&quot;,
    })

    ws.OnConnection(handleConnection)

    // Adapt the websocket server.
    // you can adapt more than one of course.
    app.Adapt(ws)

    app.Get(&quot;/&quot;, func(ctx *iris.Context) {
        ctx.ServeFile(&quot;websockets.html&quot;, false) // second parameter: enable gzip?
    })

    app.Listen(&quot;:8080&quot;)
}

</code></pre>

<pre><code>&lt;!-- websockets.html --&gt;
&lt;input id=&quot;input&quot; type=&quot;text&quot; /&gt;
&lt;button onclick=&quot;send()&quot;&gt;Send&lt;/button&gt;
&lt;pre id=&quot;output&quot;&gt;&lt;/pre&gt;
&lt;script src=&quot;/iris-ws.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
    var input = document.getElementById(&quot;input&quot;);
    var output = document.getElementById(&quot;output&quot;);

    // Ws comes from the auto-served '/iris-ws.js'
    var socket = new Ws(&quot;ws://localhost:8080/echo&quot;);
    socket.OnConnect(function () {
        output.innerHTML += &quot;Status: Connected\n&quot;;
    });

    socket.OnDisconnect(function () {
        output.innerHTML += &quot;Status: Disconnected\n&quot;;
    });

    // read events from the server
    socket.On(&quot;chat&quot;, function (msg) {
        output.innerHTML += &quot;Server: &quot; + msg + &quot;\n&quot;;
    });

    function send() {
        // send chat event data to the server
        socket.Emit(&quot;chat&quot;, input.value);
        input.value = &quot;&quot;;
    }
&lt;/script&gt;
</code></pre>

<pre><code>$ go run websockets.go
[127.0.0.1]:53403 sent: Hello Go Web Examples, you're doing great!
</code></pre>

<div class="demo">
    <input type="text">
    <button>Send</button>
    <pre>Status: Connected
Server: Hello Go Web Examples, you're doing great!</pre>
</div>

	<div class="footer">
		<div class="links">
		
			
			<a title="Sessions" class="back" href="http://gopherbook.iris-go.com/sessions/">← back</a>
			
			<a title="GopherBOOk" class="home" href="/">home</a>
			
			<a title="Render Markdown and Cache Handler" class="forward" href="http://gopherbook.iris-go.com/cache-markdown/">forward →</a>
			
		
		</div>
		<br /><br />
		 <a href="https://github.com/kataras/iris">Iris web framework</a>
	</div>
</div>
</body>
</html>
